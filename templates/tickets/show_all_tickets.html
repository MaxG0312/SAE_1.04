{% extends 'layout.html' %}

{% block title %}
<title>Tickets d'incidents</title>
{% endblock %}

{% block body %}
<h3 class="title_tickets">Dashboard des Tickets et Incidents</h3>
<hr>
<h3>Infos parcelles</h3>
La parcelle avec le plus de problèmes est la parcelle n° 
<span style="color : green;">{{ parcelle_max }}</span> avec 
<span style="color : red;">{{ ticket_parcelle[parcelle_max-1]['nombre_ticket'] }}</span> tickets.
<br>
La parcelle avec le moins de problèmes est la parcelle n°
<span style="color : green;">{{ parcelle_min }}</span> avec
<span style="color : red;">{{ ticket_parcelle[parcelle_min-1]['nombre_ticket'] }}</span> tickets.
<hr>
<div class="table-responsive">
    <h3>Résumé des statuts</h3>
    <table class="table table-striped table-sm">
        <thead>
            <tr>
                <th>Statut</th>
                <th>Nombre de tickets</th>
            </tr>
        </thead>
        <tbody>
            {% if ticket_counter | length >= 1 %}
            {% for ligne in ticket_counter %}
            <tr>
                <td style="color: red;">Tickets en attente / a traiter</td>
                <td>{{ ligne['nombre_ticket_en_attente'] }}</td>
            </tr>
            <tr>
                <td style="color : orange;">Tickets en cours</td>
                <td>{{ ligne['nombre_ticket_en_cours'] }}</td>
            </tr>
            <tr>
                <td style="color: green;">Tickets résolus</td>
                <td>{{ ligne['nombre_ticket_resolu'] }}</td>
            </tr>
            {% endfor %}
            {% endif %}
        </tbody>
    </table>
</div>
<hr>
<h3>Tickets en fonction des parcelles</h3>
<div class="table-responsive">
    <table class="table table-striped table-sm">
        <thead>
            <tr>
                <th>Parcelle</th>
                <th>Adresse</th>
                <th>Nombre de tickets</th>
                <th>Nombre de tickets en cours</th>
                <th>Nombre de tickets résolus</th>
                <th>Nombre de tickets en attente</th>

            </tr>
        </thead>
        <tbody>
            {% if ticket_parcelle | length >= 1 %}
            {% for ligne in ticket_parcelle %}
            <tr>
                <td>Parcelle <span style="color : green;">{{ ligne.id }}</span></td>
                <td>{{ ligne.adresse }}</td>
                <td>{{ ligne.nombre_ticket }}</td>
                <td>{{ ligne.nombre_ticket_en_cours }}</td>
                <td>{{ ligne.nombre_ticket_resolu }}</td>
                <td>{{ ligne.nombre_ticket_en_attente }}</td>
            </tr>
            {% endfor %}
            {% endif %}
        </tbody>
    </table>
</div>
<hr>
<div class="table-responsive">
    <h3>Tous les tickets</h3>
    <table class="table table-striped table-sm">
        <thead>
            <tr>
                <th>Id</th>
                <th>Description</th>
                <th>Date</th>
                <th>Statut</th>
                <th>Parcelle concernée</th>
            </tr>
        </thead>
        <tbody>
            {% if ticket_incident | length >= 1 %}
            {% for ligne in ticket_incident %}
            <tr>
                <td>{{ ligne.id }}</td>
                <td>{{ ligne.description }}</td>
                <td>{{ ligne.date }}</td>
                {% if ligne.statut == 'A traiter' %}
                <td style="color : red;">{{ ligne.statut }}</td>
                {% endif %}
                {% if ligne.statut == 'En cours' %}
                <td style="color : orange;">{{ ligne.statut }}</td>
                {% endif %}
                {% if ligne.statut == 'Résolu' %}
                <td style="color : green;">{{ ligne.statut }}</td>
                {% endif %}
                <td>Parcelle <span style="color : green;">{{ ligne.parcelle }}</span> : {{ ligne.adresse }}</td>
            </tr>
            {% endfor %}
            {% endif %}
        </tbody>
    </table>
</div>
<hr>



{% endblock %}